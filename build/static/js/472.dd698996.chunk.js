"use strict";(self.webpackChunkreact_monkey_blogging_boilerplate=self.webpackChunkreact_monkey_blogging_boilerplate||[]).push([[472],{5456:function(e,n,t){t.d(n,{Y:function(){return l}});t(2791);var r=t(184),o=t(1413),i=t(4925),s=t(1134),a=["checked","children","control","name"],l=function(e){var n=e.checked,t=e.children,l=e.control,c=e.name,u=(0,i.Z)(e,a),d=(0,s.bc)({control:l,name:c,defaultValue:""}).field;return(0,r.jsxs)("label",{children:[(0,r.jsx)("input",(0,o.Z)((0,o.Z)({checked:n,type:"radio",className:"hidden-input"},d),u)),(0,r.jsxs)("div",{className:"flex items-center gap-x-3 font-medium cursor-pointer",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-full border flex items-center justify-center p-1  ".concat(n?"bg-primary border-primary text-white":"border-gray-200 text-transparent"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("span",{children:t})]})]})}},9501:function(e,n,t){t.d(n,{L:function(){return h}});var r=t(1413),o=t(4925),i=t(2791),s=t(9439),a=t(184),l=(0,i.createContext)();function c(e){var n=(0,i.useState)(!1),t=(0,s.Z)(n,2),r=t[0],o=t[1],c={show:r,setShow:o,toggle:function(){o(!r)}};return(0,a.jsx)(l.Provider,{value:c,children:e.children})}function u(){var e=(0,i.useContext)(l);if("undefined"===typeof e)throw new Error("useDropdown must be used within DropdownProvider");return e}var d=["children"],h=function(e){var n=e.children,t=(0,o.Z)(e,d);return(0,a.jsx)(c,(0,r.Z)((0,r.Z)({},t),{},{children:(0,a.jsx)("div",{className:"relative inline-block w-full",children:n})}))},p=function(e){var n=e.onClick,t=u().setShow;return(0,a.jsx)("div",{className:"py-4 px-5 cursor-pointer flex items-center justify-between hover:text-primary transition-all text-sm",onClick:function(){n&&n(),t(!1)},children:e.children})},f=["placeholder"],x=function(e){var n=e.placeholder,t=(0,o.Z)(e,f),i=u().onChange;return(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("input",(0,r.Z)({type:"text",placeholder:n,className:"p-4 outline-none w-full border border-gray-200 rounded",onChange:i},t))})},m=function(e){var n=e.placeholder,t=void 0===n?"":n,r=e.className,o=void 0===r?"":r,i=u(),s=i.toggle,l=i.show;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-4 px-5 bg-white border border-grayf1 rounded-lg cursor-pointer text-sm text-[#B2B3BD] ".concat(o),onClick:s,children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)("span",{children:l?(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})}):(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})})]})},g=function(e){var n=e.children,t=u().show;return(0,a.jsx)(a.Fragment,{children:t&&(0,a.jsx)("div",{className:"absolute top-full left-0 w-full bg-white shadow-sm",children:n})})};h.Option=p,h.Search=x,h.Select=m,h.List=g},9248:function(e,n,t){t.d(n,{g:function(){return l},Y:function(){return c}});var r,o=t(168),i=(t(2791),t(6031)),s=t(184),a=i.ZP.div(r||(r=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  row-gap: 10px;\n  margin-bottom: 25px;\n"]))),l=function(e){var n=e.children;return(0,s.jsx)(a,{children:n})},c=function(e){var n=e.children;return(0,s.jsx)("div",{className:"flex flex-wrap gap-5",children:n})}},3031:function(e,n,t){var r=t(1413),o=t(4925),i=t(2791),s=t(184),a=["name","className","progress","image","handleDeleteImage"];n.Z=function(e){var n=e.name,t=e.className,l=void 0===t?"":t,c=e.progress,u=void 0===c?0:c,d=e.image,h=void 0===d?"":d,p=e.handleDeleteImage,f=void 0===p?function(){}:p,x=(0,o.Z)(e,a);return(0,s.jsxs)("label",{className:"cursor-pointer flex items-center justify-center border border-dashed w-full min-h-[200px] rounded-lg ".concat(l," relative overflow-hidden group"),children:[(0,s.jsx)("input",(0,r.Z)({type:"file",name:n,className:"hidden-input",onChange:function(){}},x)),0!==u&&!h&&(0,s.jsx)("div",{className:"absolute z-10 w-16 h-16 border-8 border-green-500 rounded-full loading border-t-transparent animate-spin"}),!h&&0===u&&(0,s.jsxs)("div",{className:"flex flex-col items-center text-center pointer-events-none",children:[(0,s.jsx)("img",{src:"/img-upload.png",alt:"upload-img",className:"max-w-[80px] mb-5"}),(0,s.jsx)("p",{className:"font-semibold",children:"Choose photo"})]}),h&&(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)("img",{src:h,className:"object-cover w-full h-full",alt:""}),(0,s.jsx)("button",{type:"button",className:"absolute z-10 flex items-center justify-center invisible w-16 h-16 text-red-500 transition-all bg-white rounded-full opacity-0 cursor-pointer group-hover:opacity-100 group-hover:visible",onClick:f,children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),!h&&(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-10 h-1 transition-all bg-green-400 image-upload-progress",style:{width:"".concat(Math.ceil(u),"%")}})]})}},3175:function(e,n,t){var r,o=t(1413),i=t(4925),s=t(168),a=(t(2791),t(6031)),l=t(1134),c=t(184),u=["name","type","children","control"],d=a.ZP.div(r||(r=(0,s.Z)(["\n  position: relative;\n  width: 100%;\n  input {\n    width: 100%;\n    padding: ",";\n    background-color: transparent;\n    border: 1px solid ",";\n    border-radius: 8px;\n    transition: all 0.2s linear;\n    color: ",";\n    font-size: 14px;\n  }\n  input::-webkit-input-placeholder {\n    color: #b2b3bd;\n  }\n  input::-moz-input-placeholder {\n    color: #b2b3bd;\n  }\n  .input-icon {\n    position: absolute;\n    right: 20px;\n    top: 50%;\n    transform: translateY(-50%);\n    cursor: pointer;\n  }\n"])),(function(e){return e.hasIcon?"16px 60px 16px 20px":"16px 20px"}),(function(e){return e.theme.grayf1}),(function(e){return e.theme.black}));n.Z=function(e){var n=e.name,t=void 0===n?"":n,r=e.type,s=void 0===r?"text":r,a=e.children,h=e.control,p=(0,i.Z)(e,u),f=(0,l.bc)({control:h,name:t,defaultValue:""}).field;return(0,c.jsxs)(d,{hasIcon:!!a,children:[(0,c.jsx)("input",(0,o.Z)((0,o.Z)({id:t,type:s},f),p)),a?(0,c.jsx)("div",{className:"input-icon",children:a}):null]})}},3117:function(e,n,t){t.d(n,{I:function(){return r.Z}});var r=t(3175)},4961:function(e,n,t){var r=t(1413),o=t(4925),i=(t(2791),t(184)),s=["on","onClick"];n.Z=function(e){var n=e.on,t=e.onClick,a=(0,o.Z)(e,s);return(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:n,className:"hidden-input",onChange:function(){},onClick:t}),(0,i.jsx)("div",(0,r.Z)((0,r.Z)({className:"inline-block w-[70px] h-[42px] relative cursor-pointer rounded-full p-1 transition-all ".concat(n?"bg-green-500":"bg-gray-300")},a),{},{children:(0,i.jsx)("span",{className:"transition-all w-[34px] h-[34px] bg-white rounded-full inline-block ".concat(n?"translate-x-[28px]":"")})}))]})}},1776:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(9439),o=t(9808),i=t(4453),s=t(2791),a=t(1830),l=t.n(a),c=t(3585);function u(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=(0,o.a)(),d=u.userInfo,h=(0,s.useState)(0),p=(0,r.Z)(h,2),f=p[0],x=p[1],m=(0,s.useState)(""),g=(0,r.Z)(m,2),v=g[0],b=g[1];if(e&&n){var j=function(e){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD||(null===d||void 0===d?void 0:d.role)===c.xZ.USER){var n=(0,i.cF)(),t=(0,i.iH)(n,"images/"+e.name),r=(0,i.B0)(t,e);r.on("state_changed",(function(e){var n=e.bytesTransferred/e.totalBytes*100;switch(x(n),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break;default:console.log("Nothing at all")}}),(function(e){console.log("Error"),b("")}),(function(){(0,i.Jt)(r.snapshot.ref).then((function(e){console.log("File available at",e),b(e)}))}))}else l().fire("Failed","You have no right to do this action","warning")},w=function(n){var t=n.target.files[0];t&&(e("image_name",t.name),j(t))},Z=function(){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD){var e=(0,i.cF)(),r=(0,i.iH)(e,"images/"+(t||n("image_name")));(0,i.oq)(r).then((function(){console.log("Remove image successfully"),b(""),x(0),a&&a()})).catch((function(e){console.log("handleDeleteImage ~ error",e),console.log("Can not delete image"),b("")}))}else l().fire("Failed","You have no right to do this action","warning")},k=function(){b(""),x(0)};return{image:v,setImage:b,handleResetUpload:k,progress:f,handleSelectImage:w,handleDeleteImage:Z}}}},5472:function(e,n,t){t.r(n);var r=t(1413),o=t(5861),i=t(9439),s=t(7757),a=t.n(s),l=t(1776),c=t(4961),u=t(333),d=t.n(u),h=t(2791),p=t(3031),f=t(1134),x=t(9808),m=t(577),g=t(5456),v=t(3585),b=t(6848),j=t(3117),w=t(9248),Z=t(9501),k=t(7823),y=t(4167),N=t(9062),I=t(8322),C=t(1830),D=t.n(C),E=t(184);n.default=function(){var e=(0,x.a)().userInfo,n=(0,f.cI)({mode:"onChange",defaultValues:{title:"",slug:"",status:2,hot:!1,image:"",category:{},user:{}}}),t=n.control,s=n.watch,u=n.setValue,C=n.handleSubmit,L=n.getValues,S=n.reset,A=s("status"),M=s("hot"),_=(0,l.Z)(u,L),P=_.image,B=_.handleResetUpload,O=_.progress,F=_.handleSelectImage,R=_.handleDeleteImage,Y=(0,h.useState)([]),V=(0,i.Z)(Y,2),J=V[0],U=V[1],T=(0,h.useState)(""),z=(0,i.Z)(T,2),G=z[0],W=z[1],H=(0,h.useState)(!1),q=(0,i.Z)(H,2),Q=q[0],K=q[1];(0,h.useEffect)((function(){function n(){return(n=(0,o.Z)(a().mark((function n(){var t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.email){n.next=2;break}return n.abrupt("return");case 2:return t=(0,N.IO)((0,N.hJ)(k.db,"users"),(0,N.ar)("email","==",e.email)),n.next=5,(0,N.PL)(t);case 5:n.sent.forEach((function(e){u("user",(0,r.Z)({id:e.id},e.data()))}));case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e.email]);var X=function(){var n=(0,o.Z)(a().mark((function n(t){var o,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===e||void 0===e?void 0:e.role)===v.xZ.ADMIN||(null===e||void 0===e?void 0:e.role)===v.xZ.MOD||(null===e||void 0===e?void 0:e.role)===v.xZ.USER){n.next=3;break}return D().fire("Failed","You have no right to do this action","warning"),n.abrupt("return");case 3:return K(!0),n.prev=4,(o=(0,r.Z)({},t)).slug=d()(t.slug||t.title,{lower:!0}),o.status=Number(t.status),i=(0,N.hJ)(k.db,"posts"),n.next=11,(0,N.ET)(i,(0,r.Z)((0,r.Z)({},o),{},{categoryId:o.category.id,userId:o.user.id,image:P,createdAt:(0,N.Bt)()}));case 11:m.Am.success("Create new post successfully!"),S({title:"",slug:"",status:2,category:{},hot:!1,image:"",user:{}}),B(),W({}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(4),K(!1);case 20:return n.prev=20,K(!1),n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[4,17,20,23]])})));return function(e){return n.apply(this,arguments)}}();(0,h.useEffect)((function(){function e(){return(e=(0,o.Z)(a().mark((function e(){var n,t,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,N.hJ)(k.db,"categories"),t=(0,N.IO)(n,(0,N.ar)("status","==",1)),e.next=4,(0,N.PL)(t);case 4:o=e.sent,i=[],o.forEach((function(e){i.push((0,r.Z)({id:e.id},e.data()))})),U(i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,h.useEffect)((function(){document.title="VBLOGGING | Add new post"}),[]);var $=function(){var e=(0,o.Z)(a().mark((function e(n){var t,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,N.JU)(k.db,"categories",n.id),e.next=3,(0,N.QT)(t);case 3:o=e.sent,u("category",(0,r.Z)({id:o.id},o.data())),W(n);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return e.role!==v.xZ.ADMIN&&e.role!==v.xZ.MOD?null:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(I.Z,{title:"Add post",desc:"Add new post"}),(0,E.jsxs)("form",{onSubmit:C(X),children:[(0,E.jsxs)("div",{className:"form-layout",children:[(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Title"}),(0,E.jsx)(j.I,{control:t,placeholder:"Enter your title",name:"title",required:!0})]}),(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Slug"}),(0,E.jsx)(j.I,{control:t,placeholder:"Enter your slug",name:"slug"})]})]}),(0,E.jsxs)("div",{className:"form-layout",children:[(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Image"}),(0,E.jsx)(p.Z,{onChange:F,handleDeleteImage:R,className:"h-[250px]",progress:O,image:P})]}),(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Category"}),(0,E.jsxs)(Z.L,{children:[(0,E.jsx)(Z.L.Select,{placeholder:"Select the category"}),(0,E.jsx)(Z.L.List,{children:J.length>0&&J.map((function(e){return(0,E.jsx)(Z.L.Option,{onClick:function(){return $(e)},children:e.name},e.id)}))})]}),(null===G||void 0===G?void 0:G.name)&&(0,E.jsx)("span",{className:"inline-block p-3 text-sm font-medium text-green-600 rounded-lg bg-green-50",children:null===G||void 0===G?void 0:G.name})]})]}),(0,E.jsxs)("div",{className:"form-layout",children:[(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Feature post"}),(0,E.jsx)(c.Z,{on:!0===M,onClick:function(){return u("hot",!M)}})]}),(0,E.jsxs)(w.g,{children:[(0,E.jsx)(b._,{children:"Status"}),(0,E.jsxs)(w.Y,{children:[(null===e||void 0===e?void 0:e.role)===v.xZ.ADMIN&&(0,E.jsx)(g.Y,{name:"status",control:t,checked:Number(A)===v.cf.APPROVED,value:v.cf.APPROVED,children:"Approved"}),(0,E.jsx)(g.Y,{name:"status",control:t,checked:Number(A)===v.cf.PENDING,value:v.cf.PENDING,children:"Pending"}),(0,E.jsx)(g.Y,{name:"status",control:t,checked:Number(A)===v.cf.REJECTED,value:v.cf.REJECTED,children:"Reject"})]})]})]}),(0,E.jsx)(y.z,{type:"submit",className:"mx-auto w-[250px]",isLoading:Q,disabled:Q,children:"Add new post"})]})]})}}}]);
//# sourceMappingURL=472.dd698996.chunk.js.map