"use strict";(self.webpackChunkreact_monkey_blogging_boilerplate=self.webpackChunkreact_monkey_blogging_boilerplate||[]).push([[43],{9248:function(e,n,r){r.d(n,{g:function(){return s},Y:function(){return c}});var t,a=r(168),o=(r(2791),r(6031)),i=r(184),l=o.ZP.div(t||(t=(0,a.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  row-gap: 10px;\n  margin-bottom: 25px;\n"]))),s=function(e){var n=e.children;return(0,i.jsx)(l,{children:n})},c=function(e){var n=e.children;return(0,i.jsx)("div",{className:"flex flex-wrap gap-5",children:n})}},3031:function(e,n,r){var t=r(1413),a=r(4925),o=r(2791),i=r(184),l=["name","className","progress","image","handleDeleteImage"];n.Z=function(e){var n=e.name,r=e.className,s=void 0===r?"":r,c=e.progress,u=void 0===c?0:c,d=e.image,p=void 0===d?"":d,m=e.handleDeleteImage,f=void 0===m?function(){}:m,h=(0,a.Z)(e,l);return(0,i.jsxs)("label",{className:"cursor-pointer flex items-center justify-center border border-dashed w-full min-h-[200px] rounded-lg ".concat(s," relative overflow-hidden group"),children:[(0,i.jsx)("input",(0,t.Z)({type:"file",name:n,className:"hidden-input",onChange:function(){}},h)),0!==u&&!p&&(0,i.jsx)("div",{className:"absolute z-10 w-16 h-16 border-8 border-green-500 rounded-full loading border-t-transparent animate-spin"}),!p&&0===u&&(0,i.jsxs)("div",{className:"flex flex-col items-center text-center pointer-events-none",children:[(0,i.jsx)("img",{src:"/img-upload.png",alt:"upload-img",className:"max-w-[80px] mb-5"}),(0,i.jsx)("p",{className:"font-semibold",children:"Choose photo"})]}),p&&(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("img",{src:p,className:"object-cover w-full h-full",alt:""}),(0,i.jsx)("button",{type:"button",className:"absolute z-10 flex items-center justify-center invisible w-16 h-16 text-red-500 transition-all bg-white rounded-full opacity-0 cursor-pointer group-hover:opacity-100 group-hover:visible",onClick:f,children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),!p&&(0,i.jsx)("div",{className:"absolute bottom-0 left-0 w-10 h-1 transition-all bg-green-400 image-upload-progress",style:{width:"".concat(Math.ceil(u),"%")}})]})}},3175:function(e,n,r){var t,a=r(1413),o=r(4925),i=r(168),l=(r(2791),r(6031)),s=r(1134),c=r(184),u=["name","type","children","control"],d=l.ZP.div(t||(t=(0,i.Z)(["\n  position: relative;\n  width: 100%;\n  input {\n    width: 100%;\n    padding: ",";\n    background-color: transparent;\n    border: 1px solid ",";\n    border-radius: 8px;\n    transition: all 0.2s linear;\n    color: ",";\n    font-size: 14px;\n  }\n  input::-webkit-input-placeholder {\n    color: #b2b3bd;\n  }\n  input::-moz-input-placeholder {\n    color: #b2b3bd;\n  }\n  .input-icon {\n    position: absolute;\n    right: 20px;\n    top: 50%;\n    transform: translateY(-50%);\n    cursor: pointer;\n  }\n"])),(function(e){return e.hasIcon?"16px 60px 16px 20px":"16px 20px"}),(function(e){return e.theme.grayf1}),(function(e){return e.theme.black}));n.Z=function(e){var n=e.name,r=void 0===n?"":n,t=e.type,i=void 0===t?"text":t,l=e.children,p=e.control,m=(0,o.Z)(e,u),f=(0,s.bc)({control:p,name:r,defaultValue:""}).field;return(0,c.jsxs)(d,{hasIcon:!!l,children:[(0,c.jsx)("input",(0,a.Z)((0,a.Z)({id:r,type:i},f),m)),l?(0,c.jsx)("div",{className:"input-icon",children:l}):null]})}},3117:function(e,n,r){r.d(n,{I:function(){return t.Z}});var t=r(3175)},7531:function(e,n,r){r.r(n);var t,a=r(1413),o=r(4925),i=r(168),l=(r(2791),r(6031)),s=r(1134),c=r(184),u=["name","type","children","control"],d=l.ZP.div(t||(t=(0,i.Z)(["\n  position: relative;\n  width: 100%;\n  textarea {\n    width: 100%;\n    padding: 16px 20px;\n    background-color: transparent;\n    border: 1px solid ",";\n    border-radius: 8px;\n    transition: all 0.2s linear;\n    color: ",";\n    font-size: 14px;\n    resize: none;\n    min-height: 200px;\n  }\n  textarea::-webkit-input-placeholder {\n    color: #b2b3bd;\n  }\n  textarea::-moz-input-placeholder {\n    color: #b2b3bd;\n  }\n"])),(function(e){return e.theme.grayf1}),(function(e){return e.theme.black}));n.default=function(e){var n=e.name,r=void 0===n?"":n,t=e.type,i=void 0===t?"text":t,l=(e.children,e.control),p=(0,o.Z)(e,u),m=(0,s.bc)({control:l,name:r,defaultValue:""}).field;return(0,c.jsx)(d,{children:(0,c.jsx)("textarea",(0,a.Z)((0,a.Z)({id:r,type:i},m),p))})}},8018:function(e,n,r){r.d(n,{g:function(){return t}});var t=r(7531).default},1776:function(e,n,r){r.d(n,{Z:function(){return u}});var t=r(9439),a=r(9808),o=r(4453),i=r(2791),l=r(1830),s=r.n(l),c=r(3585);function u(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=(0,a.a)(),d=u.userInfo,p=(0,i.useState)(0),m=(0,t.Z)(p,2),f=m[0],h=m[1],x=(0,i.useState)(""),g=(0,t.Z)(x,2),v=g[0],b=g[1];if(e&&n){var j=function(e){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD||(null===d||void 0===d?void 0:d.role)===c.xZ.USER){var n=(0,o.cF)(),r=(0,o.iH)(n,"images/"+e.name),t=(0,o.B0)(r,e);t.on("state_changed",(function(e){var n=e.bytesTransferred/e.totalBytes*100;switch(h(n),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break;default:console.log("Nothing at all")}}),(function(e){console.log("Error"),b("")}),(function(){(0,o.Jt)(t.snapshot.ref).then((function(e){console.log("File available at",e),b(e)}))}))}else s().fire("Failed","You have no right to do this action","warning")},w=function(n){var r=n.target.files[0];r&&(e("image_name",r.name),j(r))},y=function(){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD){var e=(0,o.cF)(),t=(0,o.iH)(e,"images/"+(r||n("image_name")));(0,o.oq)(t).then((function(){console.log("Remove image successfully"),b(""),h(0),l&&l()})).catch((function(e){console.log("handleDeleteImage ~ error",e),console.log("Can not delete image"),b("")}))}else s().fire("Failed","You have no right to do this action","warning")},Z=function(){b(""),h(0)};return{image:v,setImage:b,handleResetUpload:Z,progress:f,handleSelectImage:w,handleDeleteImage:y}}}},9043:function(e,n,r){r.r(n);var t=r(5861),a=r(9439),o=r(7757),i=r.n(o),l=r(4167),s=r(9248),c=r(3031),u=r(3117),d=r(6848),p=r(2185),m=r(8018),f=r(9808),h=r(7823),x=r(9062),g=r(1776),v=(r(8322),r(2791)),b=r(1134),j=r(3504),w=r(577),y=r(333),Z=r.n(y),k=r(1830),N=r.n(k),I=r(3585),D=r(184);n.default=function(){var e=(0,b.cI)({mode:"onChange"}),n=e.control,r=e.handleSubmit,o=e.reset,y=e.getValues,k=e.setValue,_=e.formState,U=_.isValid,S=_.isSubmitting,C=(0,j.lr)(),E=(0,a.Z)(C,1)[0].get("id"),F=y("avatar"),M=/%2F(\S+)\?/gm.exec(F),z=(null===M||void 0===M?void 0:M.length)>0?M[1]:"",A=(0,g.Z)(k,y,z,(function(){return O.apply(this,arguments)})),V=A.image,Y=A.setImage,J=A.progress,L=A.handleSelectImage,R=A.handleDeleteImage,B=(0,f.a)().userInfo,H=function(){var e=(0,t.Z)(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=2;break}return e.abrupt("return");case 2:if((null===B||void 0===B?void 0:B.role)===I.xZ.USER||(null===B||void 0===B?void 0:B.role)===I.xZ.ADMIN||(null===B||void 0===B?void 0:B.role)===I.xZ.MOD){e.next=5;break}return N().fire("Failed","You have no right to do this action","warning"),e.abrupt("return");case 5:return e.prev=5,r=(0,x.JU)(h.db,"users",E),e.next=9,(0,x.r7)(r,{fullname:n.fullname,email:n.email,description:n.description,username:Z()(n.username||n.fullname,{lower:!0,replacement:" ",trim:!0}),avatar:V});case 9:w.Am.success("Update user information successfully!"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0),w.Am.error("Update user failed!");case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(n){return e.apply(this,arguments)}}();function O(){return(O=(0,t.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,x.JU)(h.db,"users",E),e.next=3,(0,x.r7)(n,{avatar:""});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,v.useEffect)((function(){Y(F)}),[F,Y]),(0,v.useEffect)((function(){function e(){return(e=(0,t.Z)(i().mark((function e(){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E){e.next=2;break}return e.abrupt("return");case 2:return n=(0,x.JU)(h.db,"users",E),e.next=5,(0,x.QT)(n);case 5:r=e.sent,o(r&&r.data());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[E,o]),E?(0,D.jsx)(p.Z,{children:(0,D.jsx)("div",{className:"container",children:(0,D.jsxs)("form",{onSubmit:r(H),children:[(0,D.jsx)("div",{className:"w-[200px] h-[200px] mx-auto rounded-full mb-10",children:(0,D.jsx)(c.Z,{className:"!rounded-full h-full",onChange:L,handleDeleteImage:R,progress:J,image:V})}),(0,D.jsxs)("div",{className:"form-layout",children:[(0,D.jsxs)(s.g,{children:[(0,D.jsx)(d._,{children:"Fullname"}),(0,D.jsx)(u.I,{name:"fullname",placeholder:"Enter your fullname",control:n})]}),(0,D.jsxs)(s.g,{children:[(0,D.jsx)(d._,{children:"Username"}),(0,D.jsx)(u.I,{name:"username",placeholder:"Enter your username",control:n})]})]}),(0,D.jsx)("div",{className:"form-layout",children:(0,D.jsxs)(s.g,{children:[(0,D.jsx)(d._,{children:"Email"}),(0,D.jsx)(u.I,{name:"email",placeholder:"Enter your email",control:n,type:"email"})]})}),(0,D.jsx)("div",{className:"form-layout",children:(0,D.jsxs)(s.g,{children:[(0,D.jsx)(d._,{children:"Description"}),(0,D.jsx)(m.g,{name:"description",control:n})]})}),(0,D.jsx)(l.z,{kind:"primary",type:"submit",className:"mx-auto w-[200px]",isLoading:S,disabled:S,children:"Update"})]})})}):null}}}]);
//# sourceMappingURL=43.5ddfcf05.chunk.js.map