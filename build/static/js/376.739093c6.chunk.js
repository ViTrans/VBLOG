"use strict";(self.webpackChunkreact_monkey_blogging_boilerplate=self.webpackChunkreact_monkey_blogging_boilerplate||[]).push([[376],{7376:function(e,t,n){n.r(t);var r=n(3433),s=n(1413),c=n(5861),a=n(9439),i=n(7757),o=n.n(i),l=n(5031),d=n(4167),u=n(6848),h=n(8791),x=n(9808),f=n(7823),p=n(9062),j=n(763),v=n(8322),m=n(2791),g=n(6871),b=n(1830),w=n.n(b),y=n(3585),N=n(184);t.default=function(){var e=(0,m.useState)([]),t=(0,a.Z)(e,2),n=t[0],i=t[1],b=(0,m.useState)(""),k=(0,a.Z)(b,2),Z=k[0],C=k[1],D=(0,m.useState)(),A=(0,a.Z)(D,2),I=A[0],O=A[1],E=(0,m.useState)(0),P=(0,a.Z)(E,2),S=P[0],_=P[1],B=(0,g.s0)(),J=(0,x.a)().userInfo;function L(){return L=(0,c.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,p.JU)(f.db,"posts",t),w().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){var e=(0,c.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isConfirmed||(null===J||void 0===J?void 0:J.role)!==y.xZ.ADMIN){e.next=6;break}return e.next=3,(0,p.oe)(n);case 3:w().fire("Deleted!","Your post has been deleted.","success"),e.next=7;break;case 6:w().fire("Failed!","You have no right to delete post","warning");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}(0,m.useEffect)((function(){function e(){return(e=(0,c.Z)(o().mark((function e(){var t,n,r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.hJ)(f.db,"posts"),n=Z?(0,p.IO)(t,(0,p.ar)("title",">=",Z),(0,p.ar)("title","<=",Z+"utf8")):(0,p.IO)(t,(0,p.b9)(10)),e.next=4,(0,p.PL)(n);case 4:r=e.sent,c=r.docs[r.docs.length-1],(0,p.cf)(t,(function(e){_(e.size)})),(0,p.cf)(n,(function(e){var t=[];e.forEach((function(e){t.push((0,s.Z)({id:e.id},e.data()))})),i(t)})),O(c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[Z]);var M=function(e){switch(e){case y.cf.APPROVED:return(0,N.jsx)(u.O,{type:"success",children:"Approved"});case y.cf.PENDING:return(0,N.jsx)(u.O,{type:"warning",children:"Pending"});case y.cf.REJECTED:return(0,N.jsx)(u.O,{type:"danger",children:"Rejected"})}},Y=(0,j.debounce)((function(e){C(e.target.value)}),250),R=function(){var e=(0,c.Z)(o().mark((function e(){var t,c,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.IO)((0,p.hJ)(f.db,"posts"),(0,p.TQ)(I||0),(0,p.b9)(10)),(0,p.cf)(t,(function(e){var t=[];e.forEach((function(e){t.push((0,s.Z)({id:e.id},e.data()))})),i([].concat((0,r.Z)(n),t))})),e.next=4,(0,p.PL)(t);case 4:c=e.sent,a=c.docs[c.docs.length-1],O(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return J.role!==y.xZ.ADMIN&&J.role!==y.xZ.MOD?null:(0,N.jsxs)("div",{children:[(0,N.jsx)(v.Z,{title:"All posts",desc:"Manage all posts"}),(0,N.jsx)("div",{className:"flex justify-end gap-5 mb-10",children:(0,N.jsx)("div",{className:"w-full max-w-[300px]",children:(0,N.jsx)("input",{type:"text",className:"w-full p-4 border border-gray-300 border-solid rounded-lg",placeholder:"Search post...",onChange:Y})})}),(0,N.jsxs)(h.i,{children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Id"}),(0,N.jsx)("th",{children:"Post"}),(0,N.jsx)("th",{children:"Category"}),(0,N.jsx)("th",{children:"Author"}),(0,N.jsx)("th",{children:"Status"}),(0,N.jsx)("th",{children:"Actions"})]})}),(0,N.jsx)("tbody",{children:n.length>0&&n.map((function(e){var t,n,r,s,c,a=null!==e&&void 0!==e&&null!==(t=e.createdAt)&&void 0!==t&&t.seconds?new Date(1e3*(null===e||void 0===e||null===(n=e.createdAt)||void 0===n?void 0:n.seconds)):new Date,i=new Date(a).toLocaleDateString("vi-VI");return(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(null===(r=e.id)||void 0===r?void 0:r.slice(0,5))+"..."}),(0,N.jsx)("td",{className:"!pr-[100px]",children:(0,N.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,N.jsx)("img",{src:e.image,alt:"",className:"w-[66px] h-[55px] rounded object-cover"}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsx)("h3",{className:"font-semibold",children:e.title}),(0,N.jsxs)("time",{className:"text-sm text-gray-500",children:["Date: ",i]})]})]})}),(0,N.jsx)("td",{children:(0,N.jsx)("span",{className:"text-gray-500",children:null===(s=e.category)||void 0===s?void 0:s.name})}),(0,N.jsx)("td",{children:(0,N.jsx)("span",{className:"text-gray-500",children:null===(c=e.user)||void 0===c?void 0:c.username})}),(0,N.jsx)("td",{children:M(e.status)}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"flex items-center text-gray-500 gap-x-3",children:[(0,N.jsx)(l.kl,{onClick:function(){return B("/".concat(e.slug))}}),(0,N.jsx)(l.yd,{onClick:function(){return B("/manage/update-post?id=".concat(e.id))}}),(0,N.jsx)(l.nO,{onClick:function(){return function(e){return L.apply(this,arguments)}(e.id)}})]})})]},e.id)}))})]}),S>n.length&&(0,N.jsx)("div",{className:"mt-10 text-center",children:(0,N.jsx)(d.z,{className:"mx-auto w-[200px]",onClick:R,children:"Load more"})})]})}}}]);
//# sourceMappingURL=376.739093c6.chunk.js.map