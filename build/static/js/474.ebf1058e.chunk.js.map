{"version":3,"file":"static/js/474.ebf1058e.chunk.js","mappings":"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","sources":["drafts/action/ActionView.js","module/category/CategoryManage.js"],"sourcesContent":["import React from \"react\";\r\n\r\nconst ActionView = ({ onClick = () => {} }) => {\r\n  return (\r\n    <span\r\n      className=\"flex items-center justify-center w-10 h-10 border border-gray-200 rounded cursor-pointer\"\r\n      onClick={onClick}\r\n    >\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        className=\"w-5 h-5\"\r\n        fill=\"none\"\r\n        viewBox=\"0 0 24 24\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n      >\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\r\n        />\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"\r\n        />\r\n      </svg>\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default ActionView;\r\n","import { ActionDelete, ActionEdit } from \"components/action\";\r\nimport { Button } from \"components/button\";\r\nimport { LabelStatus } from \"components/label\";\r\nimport { Table } from \"components/table\";\r\nimport { ActionView } from \"drafts/action\";\r\nimport { db } from \"firebase-app/firebase-config\";\r\nimport {\r\n  collection,\r\n  deleteDoc,\r\n  doc,\r\n  getDocs,\r\n  limit,\r\n  onSnapshot,\r\n  query,\r\n  startAfter,\r\n  where,\r\n} from \"firebase/firestore\";\r\nimport DashboardHeading from \"module/dashboard/DashboardHeading\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { categoryStatus, userRole } from \"utils/constants\";\r\nimport Swal from \"sweetalert2\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { debounce } from \"lodash\";\r\nimport { useAuth } from \"contexts/auth-context\";\r\n\r\nconst CATEGORY_PER_PAGE = 10;\r\n\r\nconst CategoryManage = () => {\r\n  const [categoryList, setCategoryList] = useState([]);\r\n  const navigate = useNavigate();\r\n  const [filter, setFilter] = useState(undefined);\r\n  const [lastDoc, setLastDoc] = useState();\r\n  const [total, setTotal] = useState(0);\r\n  const handleLoadMoreCategory = async () => {\r\n    const nextRef = query(\r\n      collection(db, \"categories\"),\r\n      startAfter(lastDoc || 0),\r\n      limit(CATEGORY_PER_PAGE)\r\n    );\r\n\r\n    onSnapshot(nextRef, (snapshot) => {\r\n      let results = [];\r\n      snapshot.forEach((doc) => {\r\n        results.push({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        });\r\n      });\r\n      setCategoryList([...categoryList, ...results]);\r\n    });\r\n    const documentSnapshots = await getDocs(nextRef);\r\n    const lastVisible =\r\n      documentSnapshots.docs[documentSnapshots.docs.length - 1];\r\n    setLastDoc(lastVisible);\r\n  };\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      const colRef = collection(db, \"categories\");\r\n      const newRef = filter\r\n        ? query(colRef, where(\"name\", \"==\", filter))\r\n        : query(colRef, limit(CATEGORY_PER_PAGE));\r\n      const documentSnapshots = await getDocs(newRef);\r\n      const lastVisible =\r\n        documentSnapshots.docs[documentSnapshots.docs.length - 1];\r\n\r\n      onSnapshot(colRef, (snapshot) => {\r\n        setTotal(snapshot.size);\r\n      });\r\n\r\n      onSnapshot(newRef, (snapshot) => {\r\n        let results = [];\r\n        snapshot.forEach((doc) => {\r\n          results.push({\r\n            id: doc.id,\r\n            ...doc.data(),\r\n          });\r\n        });\r\n        setCategoryList(results);\r\n      });\r\n      setLastDoc(lastVisible);\r\n    }\r\n    fetchData();\r\n  }, [filter]);\r\n  const { userInfo } = useAuth();\r\n  const handleDeleteCategory = async (docId) => {\r\n    if (userInfo?.role !== userRole.ADMIN) {\r\n      Swal.fire(\"Failed\", \"You have no right to do this action\", \"warning\");\r\n      return;\r\n    }\r\n    const colRef = doc(db, \"categories\", docId);\r\n    Swal.fire({\r\n      title: \"Are you sure?\",\r\n      text: \"You won't be able to revert this!\",\r\n      icon: \"warning\",\r\n      showCancelButton: true,\r\n      confirmButtonColor: \"#3085d6\",\r\n      cancelButtonColor: \"#d33\",\r\n      confirmButtonText: \"Yes, delete it!\",\r\n    }).then(async (result) => {\r\n      if (result.isConfirmed) {\r\n        await deleteDoc(colRef);\r\n        Swal.fire(\"Deleted!\", \"Your file has been deleted.\", \"success\");\r\n      }\r\n    });\r\n  };\r\n  const handleInputFilter = debounce((e) => {\r\n    setFilter(e.target.value);\r\n  }, 500);\r\n  if (userInfo.role !== userRole.ADMIN && userInfo.role !== userRole.MOD)\r\n    return null;\r\n  return (\r\n    <div>\r\n      <DashboardHeading title=\"Categories\" desc=\"Manage your category\">\r\n        <Button kind=\"ghost\" height=\"60px\" to=\"/manage/add-category\">\r\n          Create category\r\n        </Button>\r\n      </DashboardHeading>\r\n      <div className=\"flex justify-end mb-10\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search category...\"\r\n          className=\"px-5 py-4 border border-gray-300 rounded-lg outline-none\"\r\n          onChange={handleInputFilter}\r\n        />\r\n      </div>\r\n      <Table>\r\n        <thead>\r\n          <tr>\r\n            <th>Id</th>\r\n            <th>Name</th>\r\n            <th>Slug</th>\r\n            <th>Status</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {categoryList.length > 0 &&\r\n            categoryList.map((category) => (\r\n              <tr key={category.id}>\r\n                <td>{category.id}</td>\r\n                <td>{category.name}</td>\r\n                <td>\r\n                  <span className=\"italic text-gray-400\">{category.slug}</span>\r\n                </td>\r\n                <td>\r\n                  {Number(category.status) === categoryStatus.APPROVED && (\r\n                    <LabelStatus type=\"success\">Approved</LabelStatus>\r\n                  )}\r\n                  {Number(category.status) === categoryStatus.UNAPPROVED && (\r\n                    <LabelStatus type=\"warning\">Unapproved</LabelStatus>\r\n                  )}\r\n                </td>\r\n                <td>\r\n                  <div className=\"flex items-center text-gray-500 gap-x-3\">\r\n                    <ActionView\r\n                      onClick={() => navigate(`/category/${category.slug}`)}\r\n                    ></ActionView>\r\n                    <ActionEdit\r\n                      onClick={() =>\r\n                        navigate(`/manage/update-category?id=${category.id}`)\r\n                      }\r\n                    ></ActionEdit>\r\n                    <ActionDelete\r\n                      onClick={() => handleDeleteCategory(category.id)}\r\n                    ></ActionDelete>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n        </tbody>\r\n      </Table>\r\n      {total > categoryList.length && (\r\n        <div className=\"mt-10\">\r\n          <Button onClick={handleLoadMoreCategory} className=\"mx-auto\">\r\n            Load more\r\n          </Button>\r\n          {total}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CategoryManage;\r\n"],"names":["onClick","className","xmlns","fill","viewBox","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","useState","categoryList","setCategoryList","navigate","useNavigate","undefined","filter","setFilter","lastDoc","setLastDoc","total","setTotal","handleLoadMoreCategory","nextRef","query","collection","db","startAfter","limit","onSnapshot","snapshot","results","forEach","doc","push","id","data","getDocs","documentSnapshots","lastVisible","docs","length","useEffect","colRef","newRef","where","size","fetchData","userInfo","useAuth","handleDeleteCategory","docId","role","userRole","Swal","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","isConfirmed","deleteDoc","handleInputFilter","debounce","e","target","value","DashboardHeading","desc","kind","height","to","type","placeholder","onChange","map","category","name","slug","Number","status","categoryStatus"],"sourceRoot":""}