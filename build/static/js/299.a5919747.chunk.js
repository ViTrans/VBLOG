"use strict";(self.webpackChunkreact_monkey_blogging_boilerplate=self.webpackChunkreact_monkey_blogging_boilerplate||[]).push([[299],{5456:function(e,n,t){t.d(n,{Y:function(){return l}});t(2791);var r=t(184),o=t(1413),i=t(4925),a=t(1134),s=["checked","children","control","name"],l=function(e){var n=e.checked,t=e.children,l=e.control,c=e.name,u=(0,i.Z)(e,s),d=(0,a.bc)({control:l,name:c,defaultValue:""}).field;return(0,r.jsxs)("label",{children:[(0,r.jsx)("input",(0,o.Z)((0,o.Z)({checked:n,type:"radio",className:"hidden-input"},d),u)),(0,r.jsxs)("div",{className:"flex items-center gap-x-3 font-medium cursor-pointer",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-full border flex items-center justify-center p-1  ".concat(n?"bg-primary border-primary text-white":"border-gray-200 text-transparent"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("span",{children:t})]})]})}},9501:function(e,n,t){t.d(n,{L:function(){return h}});var r=t(1413),o=t(4925),i=t(2791),a=t(9439),s=t(184),l=(0,i.createContext)();function c(e){var n=(0,i.useState)(!1),t=(0,a.Z)(n,2),r=t[0],o=t[1],c={show:r,setShow:o,toggle:function(){o(!r)}};return(0,s.jsx)(l.Provider,{value:c,children:e.children})}function u(){var e=(0,i.useContext)(l);if("undefined"===typeof e)throw new Error("useDropdown must be used within DropdownProvider");return e}var d=["children"],h=function(e){var n=e.children,t=(0,o.Z)(e,d);return(0,s.jsx)(c,(0,r.Z)((0,r.Z)({},t),{},{children:(0,s.jsx)("div",{className:"relative inline-block w-full",children:n})}))},p=function(e){var n=e.onClick,t=u().setShow;return(0,s.jsx)("div",{className:"py-4 px-5 cursor-pointer flex items-center justify-between hover:text-primary transition-all text-sm",onClick:function(){n&&n(),t(!1)},children:e.children})},f=["placeholder"],m=function(e){var n=e.placeholder,t=(0,o.Z)(e,f),i=u().onChange;return(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)("input",(0,r.Z)({type:"text",placeholder:n,className:"p-4 outline-none w-full border border-gray-200 rounded",onChange:i},t))})},x=function(e){var n=e.placeholder,t=void 0===n?"":n,r=e.className,o=void 0===r?"":r,i=u(),a=i.toggle,l=i.show;return(0,s.jsxs)("div",{className:"flex items-center justify-between py-4 px-5 bg-white border border-grayf1 rounded-lg cursor-pointer text-sm text-[#B2B3BD] ".concat(o),onClick:a,children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{children:l?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})})]})},g=function(e){var n=e.children,t=u().show;return(0,s.jsx)(s.Fragment,{children:t&&(0,s.jsx)("div",{className:"absolute top-full left-0 w-full bg-white shadow-sm",children:n})})};h.Option=p,h.Search=m,h.Select=x,h.List=g},9248:function(e,n,t){t.d(n,{g:function(){return l},Y:function(){return c}});var r,o=t(168),i=(t(2791),t(6031)),a=t(184),s=i.ZP.div(r||(r=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  row-gap: 10px;\n  margin-bottom: 25px;\n"]))),l=function(e){var n=e.children;return(0,a.jsx)(s,{children:n})},c=function(e){var n=e.children;return(0,a.jsx)("div",{className:"flex flex-wrap gap-5",children:n})}},3031:function(e,n,t){var r=t(1413),o=t(4925),i=t(2791),a=t(184),s=["name","className","progress","image","handleDeleteImage"];n.Z=function(e){var n=e.name,t=e.className,l=void 0===t?"":t,c=e.progress,u=void 0===c?0:c,d=e.image,h=void 0===d?"":d,p=e.handleDeleteImage,f=void 0===p?function(){}:p,m=(0,o.Z)(e,s);return(0,a.jsxs)("label",{className:"cursor-pointer flex items-center justify-center border border-dashed w-full min-h-[200px] rounded-lg ".concat(l," relative overflow-hidden group"),children:[(0,a.jsx)("input",(0,r.Z)({type:"file",name:n,className:"hidden-input",onChange:function(){}},m)),0!==u&&!h&&(0,a.jsx)("div",{className:"absolute z-10 w-16 h-16 border-8 border-green-500 rounded-full loading border-t-transparent animate-spin"}),!h&&0===u&&(0,a.jsxs)("div",{className:"flex flex-col items-center text-center pointer-events-none",children:[(0,a.jsx)("img",{src:"/img-upload.png",alt:"upload-img",className:"max-w-[80px] mb-5"}),(0,a.jsx)("p",{className:"font-semibold",children:"Choose photo"})]}),h&&(0,a.jsxs)(i.Fragment,{children:[(0,a.jsx)("img",{src:h,className:"object-cover w-full h-full",alt:""}),(0,a.jsx)("button",{type:"button",className:"absolute z-10 flex items-center justify-center invisible w-16 h-16 text-red-500 transition-all bg-white rounded-full opacity-0 cursor-pointer group-hover:opacity-100 group-hover:visible",onClick:f,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),!h&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 w-10 h-1 transition-all bg-green-400 image-upload-progress",style:{width:"".concat(Math.ceil(u),"%")}})]})}},3175:function(e,n,t){var r,o=t(1413),i=t(4925),a=t(168),s=(t(2791),t(6031)),l=t(1134),c=t(184),u=["name","type","children","control"],d=s.ZP.div(r||(r=(0,a.Z)(["\n  position: relative;\n  width: 100%;\n  input {\n    width: 100%;\n    padding: ",";\n    background-color: transparent;\n    border: 1px solid ",";\n    border-radius: 8px;\n    transition: all 0.2s linear;\n    color: ",";\n    font-size: 14px;\n  }\n  input::-webkit-input-placeholder {\n    color: #b2b3bd;\n  }\n  input::-moz-input-placeholder {\n    color: #b2b3bd;\n  }\n  .input-icon {\n    position: absolute;\n    right: 20px;\n    top: 50%;\n    transform: translateY(-50%);\n    cursor: pointer;\n  }\n"])),(function(e){return e.hasIcon?"16px 60px 16px 20px":"16px 20px"}),(function(e){return e.theme.grayf1}),(function(e){return e.theme.black}));n.Z=function(e){var n=e.name,t=void 0===n?"":n,r=e.type,a=void 0===r?"text":r,s=e.children,h=e.control,p=(0,i.Z)(e,u),f=(0,l.bc)({control:h,name:t,defaultValue:""}).field;return(0,c.jsxs)(d,{hasIcon:!!s,children:[(0,c.jsx)("input",(0,o.Z)((0,o.Z)({id:t,type:a},f),p)),s?(0,c.jsx)("div",{className:"input-icon",children:s}):null]})}},3117:function(e,n,t){t.d(n,{I:function(){return r.Z}});var r=t(3175)},4961:function(e,n,t){var r=t(1413),o=t(4925),i=(t(2791),t(184)),a=["on","onClick"];n.Z=function(e){var n=e.on,t=e.onClick,s=(0,o.Z)(e,a);return(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:n,className:"hidden-input",onChange:function(){},onClick:t}),(0,i.jsx)("div",(0,r.Z)((0,r.Z)({className:"inline-block w-[70px] h-[42px] relative cursor-pointer rounded-full p-1 transition-all ".concat(n?"bg-green-500":"bg-gray-300")},s),{},{children:(0,i.jsx)("span",{className:"transition-all w-[34px] h-[34px] bg-white rounded-full inline-block ".concat(n?"translate-x-[28px]":"")})}))]})}},1776:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(9439),o=t(9808),i=t(4453),a=t(2791),s=t(1830),l=t.n(s),c=t(3585);function u(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=(0,o.a)(),d=u.userInfo,h=(0,a.useState)(0),p=(0,r.Z)(h,2),f=p[0],m=p[1],x=(0,a.useState)(""),g=(0,r.Z)(x,2),v=g[0],b=g[1];if(e&&n){var j=function(e){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD||(null===d||void 0===d?void 0:d.role)===c.xZ.USER){var n=(0,i.cF)(),t=(0,i.iH)(n,"images/"+e.name),r=(0,i.B0)(t,e);r.on("state_changed",(function(e){var n=e.bytesTransferred/e.totalBytes*100;switch(m(n),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break;default:console.log("Nothing at all")}}),(function(e){console.log("Error"),b("")}),(function(){(0,i.Jt)(r.snapshot.ref).then((function(e){console.log("File available at",e),b(e)}))}))}else l().fire("Failed","You have no right to do this action","warning")},w=function(n){var t=n.target.files[0];t&&(e("image_name",t.name),j(t))},k=function(){if((null===d||void 0===d?void 0:d.role)===c.xZ.ADMIN||(null===d||void 0===d?void 0:d.role)===c.xZ.MOD){var e=(0,i.cF)(),r=(0,i.iH)(e,"images/"+(t||n("image_name")));(0,i.oq)(r).then((function(){console.log("Remove image successfully"),b(""),m(0),s&&s()})).catch((function(e){console.log("handleDeleteImage ~ error",e),console.log("Can not delete image"),b("")}))}else l().fire("Failed","You have no right to do this action","warning")},Z=function(){b(""),m(0)};return{image:v,setImage:b,handleResetUpload:Z,progress:f,handleSelectImage:w,handleDeleteImage:k}}}},2299:function(e,n,t){t.r(n),t.d(n,{default:function(){return Y}});var r=t(1413),o=t(5861),i=t(9439),a=t(7757),s=t.n(a),l=t(4167),c=t(5456),u=t(9501),d=t(9248),h=t(3031),p=t(3117),f=t(6848),m=t(4961),x=t(7823),g=t(9062),v=t(1776),b=t(8322),j=t(2791),w=t(1134),k=t(3504),Z=t(3585),y=t(6770),N=t.n(y),C=(t(6009),t(577)),I=t(8113),D=t(4569),S=t.n(D),E="https://api.imgbb.com/1/upload?key=".concat("cfe71e9e26a59994e591b6744b110c0f"),L=t(333),_=t.n(L),M=t(9808),U=t(1830),F=t.n(U),P=t(184);y.Quill.register("modules/imageUploader",I.Z);var Y=function(){var e=(0,M.a)().userInfo,n=(0,k.lr)(),t=(0,i.Z)(n,1)[0].get("id"),a=(0,j.useState)(""),y=(0,i.Z)(a,2),I=y[0],D=y[1],L=(0,w.cI)({mode:"onChange"}),U=L.handleSubmit,Y=L.control,A=L.setValue,B=L.watch,R=L.reset,J=L.getValues,O=L.formState,V=O.isValid,T=O.isSubmitting,z=J("image"),W=J("image_name"),q=(0,v.Z)(A,J,W,(function(){return $.apply(this,arguments)})),H=q.image,Q=q.setImage,G=q.progress,K=q.handleSelectImage,X=q.handleDeleteImage;function $(){return($=(0,o.Z)(s().mark((function n(){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===e||void 0===e?void 0:e.role)===Z.xZ.ADMIN){n.next=3;break}return F().fire("Failed","You have no right to do this action","warning"),n.abrupt("return");case 3:return r=(0,g.JU)(x.db,"users",t),n.next=6,(0,g.r7)(r,{avatar:""});case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}(0,j.useEffect)((function(){Q(z)}),[z,Q]);var ee=B("hot"),ne=B("status");(0,j.useEffect)((function(){function e(){return(e=(0,o.Z)(s().mark((function e(){var n,r,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=(0,g.JU)(x.db,"posts",t),e.next=5,(0,g.QT)(n);case 5:(r=e.sent).data()&&(R(r.data()),ie((null===(o=r.data())||void 0===o?void 0:o.category)||""),D((null===(i=r.data())||void 0===i?void 0:i.content)||""));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,R]);var te=(0,j.useState)(""),re=(0,i.Z)(te,2),oe=re[0],ie=re[1],ae=(0,j.useState)([]),se=(0,i.Z)(ae,2),le=se[0],ce=se[1];(0,j.useEffect)((function(){function e(){return(e=(0,o.Z)(s().mark((function e(){var n,t,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,g.hJ)(x.db,"categories"),t=(0,g.IO)(n,(0,g.ar)("status","==",1)),e.next=4,(0,g.PL)(t);case 4:o=e.sent,i=[],o.forEach((function(e){i.push((0,r.Z)({id:e.id},e.data()))})),ce(i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var ue=function(){var e=(0,o.Z)(s().mark((function e(n){var t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,g.JU)(x.db,"categories",n.id),e.next=3,(0,g.QT)(t);case 3:o=e.sent,A("category",(0,r.Z)({id:o.id},o.data())),ie(n);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),de=function(){var n=(0,o.Z)(s().mark((function n(o){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(V){n.next=2;break}return n.abrupt("return");case 2:if((null===e||void 0===e?void 0:e.role)===Z.xZ.ADMIN||(null===e||void 0===e?void 0:e.role)===Z.xZ.MOD||(null===e||void 0===e?void 0:e.role)===Z.xZ.USER){n.next=5;break}return F().fire("Failed","You have no right to do this action","warning"),n.abrupt("return");case 5:return i=(0,g.JU)(x.db,"posts",t),o.status=Number(o.status),o.slug=_()(o.slug||o.title,{lower:!0}),n.next=10,(0,g.r7)(i,(0,r.Z)((0,r.Z)({},o),{},{image:H,content:I}));case 10:C.Am.success("Update post successfully!");case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),he=(0,j.useMemo)((function(){return{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"},{align:[]}],[{header:[1,2,3,4,5,6,!1]}],["link","image","video"]],imageUploader:{upload:function(){var e=(0,o.Z)(s().mark((function e(n){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("image",n),e.next=4,S()({method:"post",url:E,data:t,headers:{"Content-Type":"multipart/form-data"}});case 4:return r=e.sent,e.abrupt("return",r.data.data.url);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}}}),[]);return t?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(b.Z,{title:"Update post",desc:"Update post content"}),(0,P.jsxs)("form",{onSubmit:U(de),children:[(0,P.jsxs)("div",{className:"form-layout",children:[(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Title"}),(0,P.jsx)(p.I,{control:Y,placeholder:"Enter your title",name:"title",required:!0})]}),(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Slug"}),(0,P.jsx)(p.I,{control:Y,placeholder:"Enter your slug",name:"slug"})]})]}),(0,P.jsxs)("div",{className:"form-layout",children:[(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Image"}),(0,P.jsx)(h.Z,{onChange:K,handleDeleteImage:X,className:"h-[250px]",progress:G,image:H})]}),(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Category"}),(0,P.jsxs)(u.L,{children:[(0,P.jsx)(u.L.Select,{placeholder:"Select the category"}),(0,P.jsx)(u.L.List,{children:le.length>0&&le.map((function(e){return(0,P.jsx)(u.L.Option,{onClick:function(){return ue(e)},children:e.name},e.id)}))})]}),(null===oe||void 0===oe?void 0:oe.name)&&(0,P.jsx)("span",{className:"inline-block p-3 text-sm font-medium text-green-600 rounded-lg bg-green-50",children:null===oe||void 0===oe?void 0:oe.name})]})]}),(0,P.jsx)("div",{className:"mb-10",children:(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Content"}),(0,P.jsx)("div",{className:"w-full entry-content",children:(0,P.jsx)(N(),{modules:he,theme:"snow",value:I,onChange:D})})]})}),(0,P.jsxs)("div",{className:"form-layout",children:[(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Feature post"}),(0,P.jsx)(m.Z,{on:!0===ee,onClick:function(){return A("hot",!ee)}})]}),(0,P.jsxs)(d.g,{children:[(0,P.jsx)(f._,{children:"Status"}),(0,P.jsxs)(d.Y,{children:[(null===e||void 0===e?void 0:e.role)===Z.xZ.ADMIN&&(0,P.jsx)(c.Y,{name:"status",control:Y,checked:Number(ne)===Z.cf.APPROVED,value:Z.cf.APPROVED,children:"Approved"}),(0,P.jsx)(c.Y,{name:"status",control:Y,checked:Number(ne)===Z.cf.PENDING,value:Z.cf.PENDING,children:"Pending"}),(0,P.jsx)(c.Y,{name:"status",control:Y,checked:Number(ne)===Z.cf.REJECTED,value:Z.cf.REJECTED,children:"Reject"})]})]})]}),(0,P.jsx)(l.z,{type:"submit",className:"mx-auto w-[250px]",isLoading:T,disabled:T,children:"Update post"})]})]}):null}}}]);
//# sourceMappingURL=299.a5919747.chunk.js.map